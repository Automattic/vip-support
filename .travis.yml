language: php

php:
  # - 5.5
  - 5.6

env:
    - WP_VERSION=latest WP_MULTISITE=0
    # - WP_VERSION=latest WP_MULTISITE=1

before_install:
  # These variables have to be set here, so they can be used by
  # prepare.sh as well as the commands in the script block below
  - export WORDPRESS_FAKE_MAIL_DIR="$(dirname $TRAVIS_BUILD_DIR)/fake-mail/"

install:
    - bash bin/install-behat.sh
    - bash bin/install-phpunit.sh wordpress_test root '' localhost $WP_VERSION

script:
    - if [[ "$WP_VERSION" == "latest" ]]; then if find . -not \( -path ./vendor -prune \) -not \( -path ./features -prune \) -name "*.php" -exec php -l {} \; | grep "^[Parse error|Fatal error]"; then exit 1; fi; fi;
    - phpunit
    - bash bin/behat.sh

notifications:
    on_success: never
    on_failure: never
    # slack: a8c:rdeQR68xgiffkssb1ZNw5P1c